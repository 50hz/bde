<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BSL 2.20 OSS: bdldfp_decimalconvertutil Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <style>
      div.hanging {
        padding-left: 0.75in;
        text-indent: -0.50in;
      }
      div.unhanging {
        text-indent:     0in;
      }
      a.glossary {
        font-weight: bold;
        font-style: italic;
      }
    </style>
</head>
<!--
<body onload='searchBox.OnSelectItem(0);'>
-->
<body>

<table border=2 cellspacing=0 cellpadding=0 align=center>
<tr>
 <td valign=top align=center>
 <p align=center><b><i>Quick Links:</i></b></p>
 </td>
 <td valign=top align=center>
 <p align=center>
<a class="qindex" href="group__bdl.html" target="_blank">bdl</a> | <a class="qindex" href="group__bsl.html" target="_blank">bsl</a>
 </td>
 </tr>
 </table>

  </div>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="components.html"><span>Components</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<h1>Component bdldfp_decimalconvertutil<br/>
<small>
[<a class="el" href="group__bdldfp.html">Package bdldfp</a>]</small>
</h1>  </div>
</div>
<div class="contents">

<p>Provide decimal floating-point conversion functions.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebdldfp.html">bdldfp</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="user"><dt><b>Outline</b></dt><dd><ul>
<li>
<a href="#1">Purpose</a> </li>
<li>
<a href="#2">Classes</a> </li>
<li>
<a href="#3">Description</a> <ul>
<li>
<a href="#3.1">Usage</a> <ul>
<li>
<a href="#3.1.1">Example 1: Sending Decimals As Octets Using Network Format</a> </li>
<li>
<a href="#3.1.2">Example 2: Storing/Sending Decimals In Binary Floating-Point</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="purpose"></a> <a class="anchor" id="1"></a> </dd></dl>
<dl class="user"><dt><b>Purpose: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Provide decimal floating-point conversion functions. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="classes"></a> <a class="anchor" id="2"></a> </dd></dl>
<dl class="user"><dt><b>Classes: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><table class="doxtable">
<tr>
<td><a class="el" href="structbdldfp_1_1DecimalConvertUtil.html">bdldfp::DecimalConvertUtil</a> </td><td>Namespace for decimal FP conversion functions  </td></tr>
</table>
</dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__bdldfp__decimal.html" title="Provide IEEE-754 decimal floating-point types.">Component bdldfp_decimal</a>, <a class="el" href="group__bdldfp__decimalplatform.html" title="Provide decimal floating-point platform information macros.">Component bdldfp_decimalplatform</a> </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="description"></a> <a class="anchor" id="3"></a> </dd></dl>
<dl class="user"><dt><b>Description: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<p>This component provides functions that are able to convert between the native decimal types of the platform and various other possible representations, such as binary floating-point, network format (big endian, DPD encoded decimals). </p>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="usage"></a> <a class="anchor" id="description.usage"></a> <a class="anchor" id="3.1"></a> </dd></dl>
<dl class="user"><dt><b>Usage: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>This section shows the intended use of this component. </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_1~3A_sending_decimals_as_octets_using_network_format"></a> <a class="anchor" id="usage.example_1~3A_sending_decimals_as_octets_using_network_format"></a> <a class="anchor" id="description.usage.example_1~3A_sending_decimals_as_octets_using_network_format"></a> <a class="anchor" id="example_1"></a> <a class="anchor" id="usage.example_1"></a> <a class="anchor" id="description.usage.example_1"></a> <a class="anchor" id="3.1.1"></a> </dd></dl>
<dl class="user"><dt><b>Example 1: Sending Decimals As Octets Using Network Format: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Suppose you have two communicating entities (programs) that talk to each other using a binary (as opposed to text) protocol. In such protocol it is important to establish a so-called network format, and convert to and from that format in the protocol layer. The sender (suppose that it is an IBM server that has just finished an expensive calculation involving millions of numbers and needs to send the result to its client) will need to convert the data to network format before sending: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   msgbuffer[256];
  <a class="code" href="namespacebdldfp.html#a5f13b247a3f13e3bffda9cfe51ee5845">BDEC::Decimal64</a> number(<a class="code" href="bdldfp__decimal_8h.html#a81f966a197ae358644d447b8ff347cb4">BDLDFP_DECIMAL_DD</a>(1.234567890123456e-42));
  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   expected[] = {
                            0x25, 0x55, 0x34, 0xb9, 0xc1, 0xe2, 0x8e, 0x56 };

  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *next = msgbuffer;
  next = <a class="code" href="structbdldfp_1_1DecimalConvertUtil.html#aed62605a2152dd64fb11ed8d76908b22">bdldfp::DecimalConvertUtil::decimalToNetwork</a>(next, number);

  assert(memcmp(msgbuffer, expected, <span class="keyword">sizeof</span>(number)) == 0);
</pre></div><br/>
<br/>
 The receiver/client shall then restore the number from network format: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   msgbuffer[] ={
                            0x25, 0x55, 0x34, 0xb9, 0xc1, 0xe2, 0x8e, 0x56 };
  <a class="code" href="namespacebdldfp.html#a5f13b247a3f13e3bffda9cfe51ee5845">BDEC::Decimal64</a> number;
  <a class="code" href="namespacebdldfp.html#a5f13b247a3f13e3bffda9cfe51ee5845">BDEC::Decimal64</a> expected(<a class="code" href="bdldfp__decimal_8h.html#a81f966a197ae358644d447b8ff347cb4">BDLDFP_DECIMAL_DD</a>(1.234567890123456e-42));

  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *next = msgbuffer;
  next = <a class="code" href="structbdldfp_1_1DecimalConvertUtil.html#a8e1e182cfeef54646fac2ee0e9ba68b7">bdldfp::DecimalConvertUtil::decimalFromNetwork</a>(number, next);

  assert(number == expected);
</pre></div><br/>
<br/>
 </dd></dl>
<dl class="user"><dt><b></b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd><a class="anchor" id="example_2~3A_storing~2Fsending_decimals_in_binary_floating-point"></a> <a class="anchor" id="usage.example_2~3A_storing~2Fsending_decimals_in_binary_floating-point"></a> <a class="anchor" id="description.usage.example_2~3A_storing~2Fsending_decimals_in_binary_floating-point"></a> <a class="anchor" id="example_2"></a> <a class="anchor" id="usage.example_2"></a> <a class="anchor" id="description.usage.example_2"></a> <a class="anchor" id="3.1.2"></a> </dd></dl>
<dl class="user"><dt><b>Example 2: Storing/Sending Decimals In Binary Floating-Point: </b></dt><dd></dd></dl>
<dl class="user"><dt><b></b></dt><dd>Suppose you have two communicating entities (programs) that talk to each other using a legacy protocol that employs binary floating-point formats to send/receive numbers. So your application layer will have to store the decimal into a binary FP variable, ensure that it can be restored (in other words that it has "fit" into the binary type) when sending, and restore the decimal number (from the binary type) when receiving: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <span class="keyword">const</span> <a class="code" href="namespacebdldfp.html#a5f13b247a3f13e3bffda9cfe51ee5845">BDEC::Decimal64</a> number(<a class="code" href="bdldfp__decimal_8h.html#a81f966a197ae358644d447b8ff347cb4">BDLDFP_DECIMAL_DD</a>(1.23456789012345e-42));

  <span class="keyword">typedef</span> <a class="code" href="structbdldfp_1_1DecimalConvertUtil.html">bdldfp::DecimalConvertUtil</a> Util;
  <span class="keywordtype">double</span> dbl = Util::decimalToDouble(number);

  <span class="keywordflow">if</span> (Util::decimal64FromDouble(dbl) != number) {
      <span class="comment">// Do what is appropriate for the application</span>
  }
</pre></div><br/>
<br/>
 Note that the above assert would probably be a lot more complicated if statement in production code. It may actually be acceptable to put the decimal onto the wire with certain amount of imprecision. </dd></dl>
<dl class="user"><dt><b></b></dt><dd>The receiver would then restore the number using the appropriate <code>decimal64FromDouble</code> function: <br/>
<br/>
<div class="fragment"><pre class="fragment">  <a class="code" href="namespacebdldfp.html#a5f13b247a3f13e3bffda9cfe51ee5845">BDEC::Decimal64</a> restored = Util::decimal64FromDouble(dbl);

  assert(number == restored);
</pre></div><br/>
<br/>
 </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Apr 7 2014 20:26:32 for BDE Release 2.20 OSS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
